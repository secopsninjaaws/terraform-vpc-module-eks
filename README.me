# ğŸŒ MÃ³dulo Terraform - VPC para Kubernetes na AWS

Este mÃ³dulo Terraform cria uma **VPC** configurada para hospedar um cluster **Kubernetes** na AWS. Ele inclui a configuraÃ§Ã£o de **subnets pÃºblicas e privadas**, um **Internet Gateway**, um **NAT Gateway** e tabelas de rotas para permitir o trÃ¡fego apropriado entre os componentes do cluster Kubernetes.

---

## ğŸ“š **Recursos Criados**
Este mÃ³dulo cria os seguintes recursos na AWS:

### âœ… **VPC**
- Cria uma VPC com o bloco CIDR definido na variÃ¡vel `cidr_block`.
- Adiciona tags para identificaÃ§Ã£o dos recursos.

---

### âœ… **Subnets PÃºblicas**
Cria trÃªs subnets pÃºblicas em diferentes zonas de disponibilidade:

| Nome | CIDR | Zona de Disponibilidade |
|-------|------|-------------------------|
| Public Subnet 1a | 10.0.20.0/24 | us-east-1a |
| Public Subnet 1b | 10.0.40.0/24 | us-east-1b |
| Public Subnet 1c | 10.0.60.0/24 | us-east-1c |

â¡ï¸ As subnets pÃºblicas sÃ£o configuradas com a tag `kubernetes.io/role/elb` para permitir o uso por Load Balancers externos no Kubernetes.

---

### âœ… **Subnets Privadas**
Cria trÃªs subnets privadas em diferentes zonas de disponibilidade:

| Nome | CIDR | Zona de Disponibilidade |
|-------|------|-------------------------|
| Private Subnet 1a | 10.0.75.0/24 | us-east-1a |
| Private Subnet 1b | 10.0.85.0/24 | us-east-1b |
| Private Subnet 1c | 10.0.95.0/24 | us-east-1c |

â¡ï¸ As subnets privadas sÃ£o configuradas com a tag `kubernetes.io/role/internal-elb` para permitir o uso por Load Balancers internos no Kubernetes.

---

### âœ… **Internet Gateway**
- Cria um Internet Gateway para permitir o acesso Ã  internet a partir das subnets pÃºblicas.

---

### âœ… **NAT Gateway**
- Cria um **Elastic IP**.
- Cria um **NAT Gateway** em uma subnet pÃºblica para permitir que as subnets privadas acessem a internet para atualizaÃ§Ãµes ou downloads.

---

### âœ… **Tabelas de Rotas**
- Cria e associa tabelas de rotas para permitir o trÃ¡fego entre os recursos:
  - **Subnets pÃºblicas** â†’ acesso Ã  internet via Internet Gateway.
  - **Subnets privadas** â†’ acesso Ã  internet via NAT Gateway.

---

## ğŸ› ï¸ **VariÃ¡veis de Entrada**
| Nome | Tipo | DescriÃ§Ã£o | Exemplo |
|-------|------|-----------|---------|
| `cidr_block` | `string` | Bloco CIDR para a VPC | `"10.0.0.0/16"` |
| `project_name` | `string` | Nome do projeto para nomeaÃ§Ã£o dos recursos | `"my-project"` |
| `tag_public_subnets` | `string` | Tag para associar Ã s subnets pÃºblicas no Kubernetes | `"1"` |
| `tag_private_subnets` | `string` | Tag para associar Ã s subnets privadas no Kubernetes | `"1"` |

---

## ğŸ“¤ **Outputs**
| Nome | DescriÃ§Ã£o |
|-------|-----------|
| `vpc_id` | ID da VPC criada |
| `public_subnets` | IDs das subnets pÃºblicas criadas |
| `private_subnets` | IDs das subnets privadas criadas |
| `internet_gateway_id` | ID do Internet Gateway criado |
| `nat_gateway_id` | ID do NAT Gateway criado |

---

## ğŸš€ **Exemplo de Uso**
Exemplo de configuraÃ§Ã£o para criar a VPC usando este mÃ³dulo:

```hcl
module "k8s_vpc" {
  source               = "./vpc-kubernetes"
  cidr_block           = "10.0.0.0/16"
  project_name         = "my-cluster"
  tag_public_subnets   = "1"
  tag_private_subnets  = "1"
}
